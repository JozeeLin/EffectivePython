# 第七章 协作开发

> python语言的某些特性,能够帮助开发者构建接口清晰,边界明确的优秀API.python开发者之间也形成了一套固定的做法,能够在程序的演化过程中尽量保持代码的可维护性.
>
> 此外,python还自带了一些标准的工具,使得分布在不同环境之中的大型开发团队,可以借助这些工具来进行协作.
>
> 如果要和别人一起研发python程序,那就必须仔细考虑代码的写法.即使程序只由你一个人来开发,你也依然会用到某些标准程序库或开源软件包,而那些模块中的代码,可能是由其他人编写的.



## 第49条: 为每个函数,类和模块编写文档字符串

> 由于python是一门动态语言,所以文档显得极其重要.而且python对文档提供了内置的支持,使得开发者可以把文档与代码块关联起来.
>
> 函数,类和模块都可以与文档字符串相关联.系统会在编译和运行python程序的过程中,维护这种联系.因为python代码支持文档字符串和\_\_doc\_\_属性,所以产生了下面三个好处:
>
> - 由于能够访问代码中的文档,所以交互式开发变得更加方便了.我们可以用内置的help函数来查看函数,类和模块的文档,也可以更加方便的采用互动式python解释器之类的工具来开发算法,测试API并编写代码片段.
>
> - 这种标准的文档定义方式,使得开发者很容易就能构建出一些工具,把纯文本转换成HTML等更为友好的格式.
>
>   例如,python开发者社区就构建了Sphinx等优秀的文档生成工具.
>
>   还有Read the Docs(readthedocs.org),有python开发者社区协力搭建的网站,能够为开源的python项目提供美观的文档及免费的存放空间.
>
> - 由于python将文档视为第一等级的(first-class)对象,而且可以令开发者在程序中访问格式良好的文档信息,所以我们很乐意编写更多的文档.python社区的开发者都坚信:文档是非常重要的.代码必须要有完备的文档.,才能称得上是好代码.



文档字符串的编写规范:PEP 257(http://www.python.org/dev/peps/pep0257):

- 为模块编写文档

  > 每个模块都应该有顶级的docstring.
  >
  > docstring第一行应该是使用一句话描述本模块的用途
  >
  > 接下来,强调本模块里面比较重要的类和函数

- 为类编写文档

  > 每个类应该有类级别的docstring,写法与模块级的docstring大致相同.
  >
  > 第一行应该是使用一句话描述本模块的用途
  >
  > 接下来用一段话详述该类的操作方式,类中比较重要的public属性及方法,也应该在docstring中强调;
  >
  > 此外,还应该告诉子类的实现者,如何才能正确地与protected属性及超类方法相交互.

- 为函数编写文档

  > 每个public函数及方法,都应该有docstring,其写法,与模块和类级别的docstring类似.
  >
  > 第一行用一句话描述本函数的功能
  >
  > 用一段话描述具体的行为和函数的参数.
  >
  > 若函数有返回值,应该在docstring中写明
  >
  > 如果函数可能抛出某些调用者必须处理的异常,而这些异常又是函数接口的一部分,那么docstring应该对其做出解释.

  特例:

  > -  如果函数没有参数,且仅有一个简单的返回值,那么,只需用一句话来描述该函数即可
  > - 如果函数没有返回值,那么最好在docstring里提到它,也就是说,不要在docstring里面出现'returns None'这样的说法
  > - 如果函数在正常的使用过程中不会抛出异常,那就不要在docstring里面提到异常.
  > - 如果函数接受数量可变的位置参数或数量可变的关键字参数,那就应该在文档的参数列表中,使用*args和**kwargs来描述它们的用途
  > - 如果函数的参数有默认值,那么应该指出这些默认值
  > - 如果函数是个生成器,那么应该描述该生成器在迭代时所产生的内容.
  > - 如果函数是个协程,那么应该描述协程所产生的值,以及这个协程希望通过yield表达式来接纳的值,同时还要说明该协程会于何时停止迭代

  

  注意:一定要保证文档能够及时更新.通过内置的doctest模块,我们很容易就能运行docstring中的范例代码,以确保源代码和文档不会在开发过程中产生偏差.

### 要点

- 我们应该通过docstring,为每个模块,类和函数编写文档.在修改代码的时候,应该更新这些文档
- 为模块编写文档时,应该介绍本模块的内容,并且要把用户应该了解的重要类及重要函数列出来
- 为类撰写文档时,应该在class语句下面的docstring中,介绍本类的行为,重要属性,以及本类的子类应该实现的行为
- 为函数及方法撰写文档时,应该在def语句下面的docstring中,介绍函数的每个参数,函数的返回值,函数在执行过程中可能抛出的异常,以及其他行为.



## 第50条: 用包来安排模块,并提供稳固的API

