# 第一章 用pythonic方式来思考

## python 2移植到python3

- 2to3,[six](https://pythonhosted.org/six/)等工具可以帮助大家把代码轻松地适配到python3及其后续版本上面

## python运行时环境

- CPython,Jython,IronPython以及PyPy等

## 遵循PEP8风格指南(8号python增提案)

- 使用空格来表示缩进,而不要用tab(制表符)
- 和语法相关的每一层缩进都用4个空格来表示
- 每行的字符数不应超过79
- 对于占据多行的表达式来说,除了首行之外,其余各行都应该在通常的缩进级别上再加上4个空格
- 文件中的函数与类之间应该用两个空行隔开
- 在同一个类中,各方法之间应该用一个空行隔开
- 在使用下标来获取列元素,调用函数或给关键字参数赋值的时候,不要在两旁添加空格
- 为变量赋值的时候,赋值符号在左侧和右侧应该各自写上一个空格,而且只写一个就好.

### 命名

> PEP8提倡采用不同的命名风格来编写python代码中的各个部分,以便在阅读代码时可以根据这些名称看出它们在python语言中的角色.

- 函数,变量及属性应该用小写字母来拼写,各单词之间以下划线连接.如lowercase_underscore
- 受保护的实例属性,应该以单个下划线开头,例如,\_leading\_underscore
- 私有的实例属性,应该以两个下划线开头,例如,_\_double\_leading\_underscore
- 类与异常,应该以每个单词首字母均大写的形式来命名,例如,CapicalizedWord
- 模块级别的常量,应该全部采用大写字母来拼写,各单词之间以下划线相连,例如,ALL_CAPS
- 类中的实例方法(instance method),应该把首个参数命名为self,以表示该对象自身
- 类方法(class method)的首个参数,应该命名为cls,以表示该类自身

### 表达式与语句

- 采用内联形式的否定词,而不要把否定词放在整个表达式的前面,例如,应该写if a is not b
- 不要通过检测长度的方法(如if len(somelist) == 0)来判断somelist是否为[]或''等空值,而是采用if not somelist这种写法来判断,它会假定:空值将自动评估为False
- 检测somelist是否为[1]或'hi'等非空值时,亦应该如此,if somelist语句默认会把非空的值判断为True
- 不要编写单行的if语句,for循环,while循环及except复合语句,而是应该把这些语句分成多行来书写,以示清晰
- import语句应该总是放在文件头
- 引入模块时,总是应该使用绝对名称,而不应该根据当前模块的路径来使用相对名称,例如,引入bar包中的foo模块时,应该完整地写出from bar import foo,而不应该写import foo
- 如果一定要以相对名称编写import语句,那就采用明确的写法: from.import foo
- 文件中的这些import语句应该按顺序划分成三个部分,分别表示标准库模块,第三方模块以及自用模块.在每一部分中,各import语句应该按模块的字母顺序来排列.

> [pylint](http://www.pylint.org/)是一款流行的python源码静态分析工具.它可以自动检查受测代码是否符合PEP8风格指南,而且还能找出Python程序里的多种常见错误.

### bytes,str和Unicode的区别

- python3有两种表示字符序列的类型:bytes和str.前者的实例包含原始的8位值,后者的实例包含Unicode字符.
- python2有两种表示字符序列的类型:str和Unicode.str的实例包含原始的8位值,而Unicode实例则包含Unicode字符.

**把Unicode字符表示成二进制数据(也就是原始8位值)有许多种方法.最常见的编码方式就是UTF8.要想把Unicode字符转换成二进制数据,就必须使用encode方法.反之则使用decode方法.**

> python代码中经常会出现两种常见的使用情境:
>
> - 开发者需要原始8位值,这些8位值表示以UTF8格式(或其他编码形式)来编码的字符
> - 开发者需要操作没有特定编码形式的Unicode字符
>
> 编写两个辅助(helper)函数,以便在这两种情况之间转换.(参见data)

常见问题:

- [python2]如果str只包含7位的ASCII字符,那么Unicode和str实例似乎成了同一种类型.可以用+操作符把这种str与Unicode连接连接.可以用等价与不等价操作符,在这种str实例与Unicode实例之间进行比较.
- [python2]在格式化字符串中,可以用'%s'等形式来代表unicode实例

#### 总结

- 二进制字符串和Unicode字符串不能通过>和+等操作符来混同操作
- 从文件中读取二进制数据,或向其中写入二进制数据时,总应该以'rb'或'wb'等二进制模式来开启文件

### 用辅助函数来取代复杂的表达式



